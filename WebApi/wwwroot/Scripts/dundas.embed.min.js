"use strict";(function(){var n=!1,u=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,t=function(n,t){if(typeof n=="object"&&n&&n.__classType){var r=dundas.Utility.objectFromString(n.__classType),i=new r;i.fromJObject(n,t);n=i}return n},f=this||window,r,i;f.Class=function(){};Class.fromJSON=function(n){var i=null,t=$.parseJSON(n),r;return t&&t.__classType&&(r=dundas.Utility.objectFromString(t.__classType),i=new r,i.fromJObject(t)),i};Class.clone=function(n){return t(n,!0)};Class.prototype.fromJObject=function(n,i){var u,r,f,e;for(u in n)if(typeof n[u]!="function"&&u[0]!=="_"&&u in this){if(r=n[u],r=t(r,i),r instanceof Array)for(i&&(r=r.slice(0)),f=0,e=r.length;f<e;f++)r[f]=t(r[f],i);try{this[u]=r}catch(o){if(!(o instanceof TypeError))throw o;}}};Class.prototype.toJSON=function(){var i={},t,n;for(t in this)(t==="__classType"||t[0]!=="_")&&(n=this[t],typeof n!="function"&&(n||n===0||n===!1||n==="")&&(i[t]=n));return i};r=function(n,t,i){return i.indexOf(n)===t};i=function(t){function h(){!n&&this.init&&this.init.apply(this,arguments)}var l=this.prototype,e,f,s,c,o,a;n=!0;e=new this;n=!1;for(f in t)if(typeof t[f]=="function"&&typeof l[f]=="function"&&u.test(t[f]))e[f]=function(n,t){return function(){var r=this._super,i;return this._super=l[n],i=t.apply(this,arguments),this._super=r,i}}(f,t[f]);else if(f=="__properties"){if(s=t[f],c=[],Object.defineProperty)for(o in s)s[o].notEnumerable||(s[o].enumerable=!0),c.push(o),Object.defineProperty(e,o,s[o]);e.__propertyNames||(e.__propertyNames=[]);a=e.__propertyNames.concat(c);e.__propertyNames=a.filter(r)}else e[f]=t[f];return h.prototype=e,h.constructor=h,h.extend=i,h};Class.extend=i;String.prototype.startsWith||(String.prototype.startsWith=function(n,t){return this.substr(t||0,n.length)===n});window.dundas={};window.dundas.embed={};window.dundas.embed.tokens={};window.dundas.embed.logon={};window.dundas.embed.helperMethods={};window.dundas.embed.helperMethods.xmlHttpRequest={};window.dundas.embed.shortlink={};window.dundas.embed.console={};dundas.embed.ControllerType={DASHBOARD:"Dashboard",SCORECARD:"Scorecard",REPORT:"Report",SHORTLINK:"Shortlink"};dundas.embed.ViewOptions={MENU_ONLY:"menuonly",MENU_TOOLBAR:"menutoolbar",MENU_TOOLBAR_TASKBAR:"menutoolbartaskbar",NONE:"none",TOOLBAR_ONLY:"toolbaronly",VIEW_ONLY:"viewonly"};dundas.embed.tokens.basic={ALL:"$*$",DEFAULT:"$D$",NULL:"$N$",OPEN_RANGE:"$OR$",NO_SELECTION:"$NoSel$"};dundas.embed.tokens.DateRange={TODAY:"$TODAY$",CURRENT_YEAR:"$CY$",CURRENT_QUARTER:"$CQ$",CURRENT_MONTH:"$CM$",CURRENT_WEEK:"$CW$",CURRENT_DAY:"$CD$",PREVIOUS_YEAR:"$PY$",PREVIOUS_QUARTER:"$PQ$",PREVIOUS_MONTH:"$PM$",PREVIOUS_WEEK:"$PW$",PREVIOUS_DAY:"$PD$",YEAR_TO_DATE:"$YTD$",QUARTER_TO_DATE:"$QTD$",MONTH_TO_DATE:"$MTD$"};dundas.embed.tokens.SingleDate={BEGINNING_OF_CURRENT_YEAR:"$BOCY$",BEGINNING_OF_CURRENT_QUARTER:"$BOCQ$",BEGINNING_OF_CURRENT_MONTH:"$BOCM$",BEGINNING_OF_CURRENT_WEEK:"$BOCW$",BEGINNING_OF_CURRENT_DAY:"$BOCD$",END_OF_CURRENT_YEAR:"$EOCY$"};dundas.embed.logon.disableWithCredentialsFlag=!1;dundas.embed.helperMethods={createGuid:function(){var n=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)},t=function(){return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()};return t()},trimTrailingSlash:function(n){return n.replace(/\/$/,"")}};dundas.embed.console={ignoreInformation:!1,info:function(n){dundas.embed.console.ignoreInformation||console.info(n)}};window.dundas.embed.helperMethods.xmlHttpRequest={headerContentType:{x_www_form_urlencoded:"application/x-www-form-urlencoded",json:"application/json"},processWithCredentials:function(n,t){t.toLowerCase().startsWith("https://")&&(dundas.embed.logon.disableWithCredentialsFlag||(n.withCredentials="true"))},addConstantRequestHeaders:function(n,t){t==dundas.embed.helperMethods.xmlHttpRequest.headerContentType.json?n.setRequestHeader("Content-Type","application/json; charset=utf-8"):t==dundas.embed.helperMethods.xmlHttpRequest.headerContentType.x_www_form_urlencoded&&n.setRequestHeader("Content-Type","application/x-www-form-urlencoded");n.setRequestHeader("Accept","application/json")},xmlHttpRequestOnLoad:function(n,t,i){n.onload=i?function(){if(n.status===200){var i=JSON.parse(n.responseText);t&&t(i)}}:function(){n.status===200&&t&&t()}},createParamsFromObject:function(n){return Object.keys(n).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(n[t])}).join("&")}};window.dundas.embed.shortlink.defaultTimeToLive="01:00:00";window.dundas.embed.shortlink.generateShortLinkWithSessionId=function(n,t,i,r,u){var f=new XMLHttpRequest,e=trimTrailingSlash(n)+"/API/ShortLink/Link/";f.open("POST",e+"?sessionId="+t,!0);dundas.embed.helperMethods.xmlHttpRequest.addConstantRequestHeaders(f,dundas.embed.helperMethods.xmlHttpRequest.headerContentType.json);dundas.embed.helperMethods.xmlHttpRequest.processWithCredentials(f,e);dundas.embed.helperMethods.xmlHttpRequest.xmlHttpRequestOnLoad(f,u,!0);f.send(JSON.stringify({longLink:i,timeToLive:r}))};dundas.embed.logon.deleteCurrentSession=function(n,t,i){var r=new XMLHttpRequest,u=dundas.embed.helperMethods.trimTrailingSlash(n)+"/API/Session/Current";r.open("DELETE",u+"?sessionid="+t,!0);dundas.embed.helperMethods.xmlHttpRequest.addConstantRequestHeaders(r,dundas.embed.helperMethods.xmlHttpRequest.headerContentType.json);dundas.embed.helperMethods.xmlHttpRequest.processWithCredentials(r,u);dundas.embed.helperMethods.xmlHttpRequest.xmlHttpRequestOnLoad(r,i,!1);r.send()};dundas.embed.logon.useLogonToken=function(n,t,i){var r=new XMLHttpRequest,u=dundas.embed.helperMethods.trimTrailingSlash(n)+"/API/LogOn/";r.open("POST",u,!0);dundas.embed.helperMethods.xmlHttpRequest.addConstantRequestHeaders(r,dundas.embed.helperMethods.xmlHttpRequest.headerContentType.x_www_form_urlencoded);dundas.embed.helperMethods.xmlHttpRequest.processWithCredentials(r,u);dundas.embed.helperMethods.xmlHttpRequest.xmlHttpRequestOnLoad(r,i,!0);r.send(dundas.embed.helperMethods.xmlHttpRequest.createParamsFromObject(t))};dundas.embed.logon.getLogonToken=function(n,t,i){var r=new XMLHttpRequest,u=dundas.embed.helperMethods.trimTrailingSlash(n)+"/API/LogOn/Token/";r.open("POST",u,!0);dundas.embed.helperMethods.xmlHttpRequest.addConstantRequestHeaders(r,dundas.embed.helperMethods.xmlHttpRequest.headerContentType.x_www_form_urlencoded);dundas.embed.helperMethods.xmlHttpRequest.processWithCredentials(r,u);dundas.embed.helperMethods.xmlHttpRequest.xmlHttpRequestOnLoad(r,i,!0);r.send(dundas.embed.helperMethods.xmlHttpRequest.createParamsFromObject(t))};window.dundas.embed.shortlink.generateShortLinkWithLogonToken=function(n,t,i,r,u,f){dundas.embed.logon.useLogonToken(n,{logonToken:t,deleteOtherSessions:i},function(t){dundas.embed.shortlink.generateShortLinkWithSessionId(n,t.sessionId,r,u,function(i){dundas.embed.logon.deleteCurrentSession(n,t.sessionId,function(){dundas.embed.logon.deleteCurrentSession(n,t.sessionId,function(){f(i)})})})})};dundas.embed.UrlParamterOption=Class.extend({init:function(n,t){this._name=n;this._value=t},toUrlParameter:function(){return{name:this._name,value:this._value}},__properties:{__classType:{get:function(){return"dundas.embed.UrlParamterOption"}},name:{get:function(){return this._name},set:function(n){this._name=n}},value:{get:function(){return this._value},set:function(n){this._value=n}}}});dundas.embed.ParameterValue=Class.extend({init:function(n,t){this._name=n;this._value=t},toUrlParameter:function(){return this._name.indexOf("$")==0?{name:this._name,value:this._value}:{name:"$"+this._name,value:this._value}},__properties:{__classType:{get:function(){return"dundas.embed.ParameterValue"}},name:{get:function(){return this._name},set:function(n){this._name=n}},value:{get:function(){return this._value},set:function(n){this._value=n}}}});dundas.embed.EmbeddedApp=Class.extend({init:function(n,t,i,r,u,f,e,o,s){this._id=n;this._dundasBIUrl=t;this._controllerType=i;this._fileSystemId=r;this._logonTokenId=u;this._viewOptions=f;this._shortLink=e;this._otherUrlParameterOptions=s;this._parameterValues=o},validateProperties:function(){if(!this._dundasBIUrl)throw"The Dundas BI URI is not specified.";if(!this._controllerType)throw"No controller type was specified in the embed options.";if(!this._fileSystemId)throw"No file system ID was specified.";},refresh:function(){var n=document.getElementById(this._id);n.src=n.src},getFullUrl:function(){var t=[],r=function(n){for(var i="",t=0;t<n.length;t++)i+=t==0?"?":"&",i+=n[t].name+"="+n[t].value;return i},n,i;if(this._logonTokenId&&t.push({name:"logonTokenId",value:this._logonTokenId}),this._shortLink&&t.push({name:"shortLink",value:this._shortLink}),this._viewOptions&&t.push({name:"vo",value:this._viewOptions}),this._parameterValues)for(n=0;n<this._parameterValues.length;n++)t.push(this._parameterValues[n].toUrlParameter());if(this._otherUrlParameterOptions)for(n=0;n<this._otherUrlParameterOptions.length;n++)t.push(this._otherUrlParameterOptions[n].toUrlParameter());return i=r(t),this._controllerType==dundas.embed.ControllerType.SHORTLINK?dundas.embed.helperMethods.trimTrailingSlash(this._dundasBIUrl)+"/Link/"+i:dundas.embed.helperMethods.trimTrailingSlash(this._dundasBIUrl)+"/"+this._controllerType+"/"+this._fileSystemId+i},load:function(){if(this.dundasBIUrl){var n=document.getElementById(this._id);n.src=this.getFullUrl()}},loadAndCreateShortLink:function(n){var t=this,r,i,u,f;if(n&&(r=n.logOnTokenId),n&&(i=n.deleteOtherSessions),i||(i=!0),r){if(t.logonTokenId==r){console.error("The logon token ID for this loadAndCreateShortLink function cannot be the same as the logon token in the embedded app.");return}u=t.logonTokenId;t.logonTokenId=null;f=t.getFullUrl().replace(dundas.embed.helperMethods.trimTrailingSlash(t.dundasBIUrl),"");dundas.embed.shortlink.generateShortLinkWithLogonToken(t.dundasBIUrl,r,i,f,window.dundas.embed.shortlink.defaultTimeToLive,function(n){t.parameterValues=[];t.otherUrlParameterOptions=[];t.viewOptions=null;t.controllerType=dundas.embed.ControllerType.SHORTLINK;t.shortLink=n;t.logonTokenId=u;t.load()})}else t.logonTokenId?(dundas.embed.console.info("A seperate logon token was not supplied in the option to the loadAndCreateShortLink function.  This will cause the session ID to visible in the url.  It is strongly recommended to create a seperate logon token and pass in the options to the loadAndCreateShortLink function."),dundas.embed.logon.useLogonToken(dundasBIUrl,{logOnToken:t.logonTokenId,deleteOtherSessions:i},function(n){var i=t.getFullUrl().replace(dundas.embed.helperMethods.trimTrailingSlash(t.dundasBIUrl),"");dundas.embed.shortlink.generateShortLinkWithSessionId(dundasBIUrl,n.sessionId,i,window.dundas.embed.shortlink.defaultTimeToLive,function(i){t.parameterValues=[];t.otherUrlParameterOptions=[new dundas.embed.UrlParamterOption("sessionid",n.sessionId)];t.viewOptions=null;t.controllerType=dundas.embed.ControllerType.SHORTLINK;t.shortLink=i;t.logonTokenId=null;t.load()})})):console.error("Unable to create a short link as a logon token does not exist.")},loaded:function(n){var t=document.getElementById(this._id),i,r;t.onload?(i=t.onload,r=function(){i();n()},t.onload=r):t.onload=n},runScript:function(n,t,i){var u=document.getElementById(this._id),r=dundas.embed.helperMethods.createGuid(),f="window.dundas.embed = {};var scriptId = '"+r+"'; var dundasEmbeddedApplicationId = '"+this._id+"';                                                                                               dundas.embed.sendMessageToDundasEmbeddedApplication = function(message)                             {                                                                                                       var messageObject =                                                                                     {                                                                                                       'dundasEmbeddedApplicationId': dundasEmbeddedApplicationId,                                         'scriptId': scriptId,                                                                               'message': message                                                                              };                                                                                              window.parent.postMessage(JSON.stringify(messageObject), '*');                                  };                                                                                                  ";document.addEventListener("MessageReceived-"+r,i);u.contentWindow.postMessage({isAsync:!1,script:f+n},"*")},ready:function(n){document.addEventListener("DashboardReady-"+this._id,n)},__properties:{__classType:{get:function(){return"dundas.embed.EmbeddedApp"}},id:{get:function(){return this._id}},dundasBIUrl:{get:function(){return this._dundasBIUrl},set:function(n){this._dundasBIUrl=n}},controllerType:{get:function(){return this._controllerType},set:function(n){this._controllerType=n}},fileSystemId:{get:function(){return this._fileSystemId},set:function(n){this._fileSystemId=n}},logonTokenId:{get:function(){return this._logonTokenId},set:function(n){this._logonTokenId=n}},shortLink:{get:function(){return this._shortLink},set:function(n){this._shortLink=n}},viewOptions:{get:function(){return this._viewOptions},set:function(n){this._viewOptions=n}},parameterValues:{get:function(){return this._parameterValues},set:function(n){this._parameterValues=n}},otherUrlParameterOptions:{get:function(){return this._otherUrlParameterOptions},set:function(n){this._otherUrlParameterOptions=n}}}});dundas.embed.create=function(n,t){for(var r,u,o,s,h,c=dundas.embed.helperMethods.createGuid(),l=function(n,t){var i=n.dataset.dundasBiUrl;return i?i:t&&t.dundasBIUrl?t.dundasBIUrl:void 0},a=function(n,t){var i=n.dataset.controllerType;return i?i:t&&t.controllerType?t.controllerType:void 0},v=function(n,t){var i=n.dataset.fileSystemId;return i?i:t&&t.fileSystemId?t.fileSystemId:void 0},y=function(n,t){var i=n.dataset.viewOptions;return i?i:t&&t.viewOptions?t.viewOptions:dundas.embed.ViewOptions.VIEW_ONLY},p=l(n,t),w=a(n,t),b=v(n,t),k=function(n,t){var i=n.dataset.logonTokenId;return i?i:t&&t.logonTokenId?t.logonTokenId:null},d=k(n,t),g=function(n,t){var i=n.dataset.shortlink;return i?i:t&&t.shortLink?t.shortLink:null},nt=g(n,t),tt=y(n,t),f=[],e=[],i=0;i<=n.attributes.length;i++)r=n.attributes[i],r&&(r.name.startsWith("data-parametervalue")?(u=r.value.split("="),f.push(new dundas.embed.ParameterValue(u[0],u[1]))):r.name.startsWith("data-urlparameteroption")&&(u=r.value.split("="),e.push(new dundas.embed.UrlParamterOption(u[0],u[1]))));if(o=[],t&&t.parameterValues&&(o=t.parameterValues),f.length>0)for(i=0;i<f.length;i++)o.push(f[i]);if(s=[],t&&t.otherUrlParameterOptions&&(s=t.otherUrlParameterOptions),e.length>0)for(i=0;i<e.length;i++)s.push(e[i]);return h=new dundas.embed.EmbeddedApp(c,p,w,b,d,tt,nt,o,s),n.innerHTML='<iframe id="'+c+'" style="height:100%; width:100%;border: 0px solid white; display: block; " ><\/iframe>',h.loaded(function(){h.runScript("window.dundas.context.ready(function() { dundas.embed.sendMessageToDundasEmbeddedApplication('DashboardReady'); });",!1)}),h};document.addEventListener("DOMContentLoaded",function(){function r(n){var r=n.data,t=JSON.parse(r),i=document.createEvent("CustomEvent");t.message=="DashboardReady"?(i.initCustomEvent("DashboardReady-"+t.dundasEmbeddedApplicationId,!1,!1,{}),document.dispatchEvent(i)):(i.initCustomEvent("MessageReceived-"+t.scriptId,!1,!1,t.message),document.dispatchEvent(i))}for(var i,t=document.getElementsByClassName("dundas-bi-embed"),n=0;n<t.length;n++)i=dundas.embed.create(t[n]),i.load();window.addEventListener("message",r,!1)})})()